---
title: "Untitled"
author: "Julien Diot"
date: "2024-11-25"
output:
  ioslides_presentation:
    # css: src/style.css # not working within the nix package
    logo: src/imgs/IBS_IBC-Logo_2023.png
    widescreen: yes
    incremental: false
    smaller: false
    transition: faster
runtime: shiny
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  results = "hold" # display chunk output in one block
)

library(flair)
library(dplyr)
library(plotly)
library(shiny)
```

```{r css, results='asis'}
htmltools::includeCSS("src/style.css")
```

## R Markdown

This is an R Markdown presentation. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

## Slide with Bullets

- Bullet 1
- Bullet 2
- Bullet 3

## Slide with R Output

```{r cars, echo = TRUE}
summary(cars)
```




## Interactive Plot

```{r eruptions, results='markup'}
inputPanel(
  selectInput("n_breaks", label = "Number of bins:",
              choices = c(10, 20, 35, 50), selected = 20),

  sliderInput("bw_adjust", label = "Bandwidth adjustment:",
              min = 0.2, max = 2, value = 1, step = 0.2)
)

renderPlot({
  hist(faithful$eruptions, probability = TRUE, breaks = as.numeric(input$n_breaks),
       xlab = "Duration (minutes)", main = "Geyser eruption duration")

  dens <- density(faithful$eruptions, adjust = input$bw_adjust)
  lines(dens, col = "blue")
})
```


## Shiny app

```{r shinyapp, results='markup'}
sidebarPanel(
  sliderInput("bins",
              "Number of bins:",
              min = 1,
              max = 50,
              value = 30)
)

mainPanel(
  renderPlot({
    # generate bins based on input$bins from ui.R
    x    <- faithful[, 2]
    bins <- seq(min(x), max(x), length.out = input$bins + 1)
    
    # draw the histogram with the specified number of bins
    hist(x, breaks = bins, col = 'darkgray', border = 'white',
         xlab = 'Waiting time to next eruption (in mins)',
         main = 'Histogram of waiting times')
  })
)
```

## Shiny with plotly


<div class="sideBar_left">

```{r echo = FALSE}
data <- iris
columns <- colnames(data)

selectInput("x_var", "X variable", choices = columns, selected = columns[1])
selectInput("y_var", "Y variable", choices = columns, selected = columns[2])

```

</div>


<div class="sideBar_right">

```{r echo = FALSE, out.width = '10%'}
renderPlotly({

  plot_data <- data[, c(input$x_var, input$y_var, "Species")]
  colnames(plot_data) <- c("x_var", "y_var", "color")

  p <- plot_ly(
    type = 'scatter',
    mode = 'markers',
    height = 400,
    width = 800,
    data = plot_data,
    x = ~x_var,
    y = ~y_var,
    color = ~color,
    hoverinfo = "text",
    text = apply(data, 1, function(l) { # data must be in the same order as plot_data here !
      paste(names(l), ":", l, collapse = "\n")
    })
  ) %>%
    layout(
      autosize = F,
      xaxis = list(title = input$x_var),
      yaxis = list(title = input$y_var)
    )
  
  p
})
```

</div>



## how_to_pipe

```{r how_to_pipe, include = FALSE}
print("toto")
print("tata")
print("titi")
print("tutu")
```


```{r, echo = FALSE}
decorate("how_to_pipe") %>%
  flair_lines(c(2, 4))
```


## Slide with Plot

```{r pressure}
plot(pressure)
```

